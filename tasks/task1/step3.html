<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Step 3: pyATS Capabilities using the pyATS Shell &mdash; LTRATO-2001  documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Step 4: pyATS Shell Useful Libraries" href="step4.html" />
    <link rel="prev" title="Step 2: Verify pyATS Testbed File" href="step2.html" /> <link href="../../_static/style.css" rel="stylesheet" type="text/css"> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            LTRATO-2001
              <img src="../../_static/CL-2023.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/index.html#learning-objectives">Learning Objectives</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../labaccess/index.html">Lab Access</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../labaccess/index.html#ip-addressing-and-access-information">IP Addressing and Access Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../labaccess/index.html#component-details">Component Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../labaccess/index.html#get-started">Get Started</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tasks</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Task 1: Exploring and Verification</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="step1.html">Step 1: Explore Lab Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="step2.html">Step 2: Verify pyATS Testbed File</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Step 3: pyATS Capabilities using the pyATS Shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="step4.html">Step 4: pyATS Shell Useful Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../task2/index.html">Task 2: Writing Initial Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../task2/step1.html">Step 1: Collect Show Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../task2/step2.html">Step 2: Writing Test Script</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../task3/index.html">Task 3: Verification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../task3/step1.html">Step 1: Verify Log Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../task3/step2.html">Step 2: Verify the Service Contracts Coverage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../task3/step3.html">Step 3: Verify the Routing Information using Parsers and pyATS Learn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../task3/step4.html">Step 4: Run PING to Verify Reachability</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../task4/index.html">Task 4: Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../task4/step1.html">Step 1: Show the Results of Tests in a Browser</a></li>
<li class="toctree-l3"><a class="reference internal" href="../task4/step2.html">Step 2: Run tests and compare results from XPRESSO dashboard</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../conclusions.html">Conclusions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix.html">Appendix: A</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../appendix.html#links">Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appendix.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../appendix.html#configuration-compliance">Configuration Compliance</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">LTRATO-2001</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Tasks</a></li>
          <li class="breadcrumb-item"><a href="index.html">Task 1: Exploring and Verification</a></li>
      <li class="breadcrumb-item active">Step 3: pyATS Capabilities using the pyATS Shell</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/tasks/task1/step3.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="step-3-pyats-capabilities-using-the-pyats-shell">
<h1>Step 3: pyATS Capabilities using the pyATS Shell<a class="headerlink" href="#step-3-pyats-capabilities-using-the-pyats-shell" title="Permalink to this headline">¶</a></h1>
<p><strong>Value Proposition:</strong> We believe it is always faster to start learning about pyATS in an interactive format where you can try different pyATS functions.
Learning in an interactive format allows you to run commands and see results immediately instead of making small changes in Python code and re-running it after every minor change.
pyATS has an interactive shell for developing tests, and it is executed from a Bash shell in the following way:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats shell --testbed-file &lt;testbed_file_name&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pyATS interactive shell will be called <strong>pyATS shell</strong> throughout this guide</p>
</div>
<p>Let’s begin with the pyATS shell, using it with <code class="docutils literal notranslate"><span class="pre">pyats_testbed.yaml</span></code>, which we’ve seen in the previous task.</p>
<p>You will be using the following pyATS methods throughout this task:</p>
<ul class="simple">
<li><p>pyATS connect</p></li>
<li><p>pyATS execute</p></li>
<li><p>pyATS parse</p></li>
<li><p>pyATS learn</p></li>
<li><p>pyATS diff</p></li>
</ul>
<ol class="arabic">
<li><p>Enter the following command to run the pyATS shell command from the Bash shell and specify the YAML testbed file as the parameter. This shell is where you can run the Python code.</p>
<blockquote>
<div><div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The interactive shell might take some time to load (approximately 20 seconds)</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats shell --testbed-file pyats_testbed.yaml
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>The output of the command should contain the following (the version of Python might differ):</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Welcome to pyATS Interactive <span class="nv">Shell</span>
<span class="o">==================================</span>
Python <span class="m">3</span>.8.7 <span class="o">(</span>default, Mar <span class="m">30</span> <span class="m">2021</span>, <span class="m">10</span>:31:15<span class="o">)</span>
<span class="o">[</span>GCC <span class="m">7</span>.4.0<span class="o">]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Check the devices included in the lab’s testbed.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">testbed</span><span class="o">.</span><span class="n">devices</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>The output of the command should contain the following:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>TopologyDict<span class="o">({</span><span class="s1">&#39;asav-1&#39;</span>: &lt;Device asav-1 at 0x7f5342e17210&gt;, <span class="s1">&#39;csr1000v-1&#39;</span>: &lt;Device csr1000v-1 at 0x7f5342deced0&gt;, <span class="s1">&#39;nx-osv-1&#39;</span>: &lt;Device nx-osv-1 at 0x7f5341998890&gt;<span class="o">})</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Create variables (Python objects) to call devices easily (<strong>nx - ‘nx-osv-1’</strong> device, <strong>asa -‘asav-1’</strong> device):</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span> <span class="o">=</span> <span class="n">testbed</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="s1">&#39;nx-osv-1&#39;</span><span class="p">]</span>
<span class="n">asa</span> <span class="o">=</span> <span class="n">testbed</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="s1">&#39;asav-1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Connect and collect raw output from devices.</p>
<blockquote>
<div><ul>
<li><p>Connect to devices from the pyATS shell:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">asa</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Let’s prepare for our first test and collect the output of the <strong>show inventory</strong> command from the devices.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nx_output</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;show inventory&#39;</span><span class="p">)</span>
<span class="n">asa_output</span> <span class="o">=</span> <span class="n">asa</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;show inventory&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>Verify the collected information for each command. Pay attention to the output of both executed methods returned as plain text (string type in Python):</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nx-osv-1#
Out<span class="o">[</span><span class="m">6</span><span class="o">]</span>: <span class="s1">&#39;NAME: &quot;Chassis&quot;,  DESCR: &quot;Nexus9000 9000v Chassis&quot; \r\nPID: N9K-9000v,  VID: V02 ,  SN: 9OQ8QSK7JX1 \r\n\r\nNAME: &quot;Slot 1&quot;,  DESCR: &quot;Nexus 9000v Ethernet Module&quot; \r\nPID: N9K-9000v,  VID: V02 ,  SN: 9OQ8QSK7JX1 \r\n\r\nNAME: &quot;Fan 1&quot;,  DESCR: &quot;Nexus9000 9000v Chassis Fan Module&quot;  \r\nPID: N9K-9000v-FAN,  VID: V01 ,  SN: N/A \r\n\r\nNAME: &quot;Fan 2&quot;,  DESCR: &quot;Nexus9000 9000v Chassis Fan Module&quot; \r\nPID: N9K-9000v-FAN,  VID: V01 ,  SN: N/A \r\n\r\nNAME: &quot;Fan 3&quot;,  DESCR: &quot;Nexus9000 9000v Chassis Fan Module&quot; \r\nPID: N9K-9000v-FAN,  VID: V01 ,  SN: N/A&#39;</span>
asav-1#
Out<span class="o">[</span><span class="m">7</span><span class="o">]</span>: <span class="s1">&#39;Name: &quot;Chassis&quot;, DESCR: &quot;ASAv Adaptive Security Virtual Appliance&quot;\r\nPID: ASAv, VID: V01, SN: 9AWXBH2QJP7&#39;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Convert the output to structured data using the <strong>parse</strong> command.</p>
<blockquote>
<div><ul>
<li><p>Import <strong>pprint</strong> python module to view the collected output in a better format.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Run the <strong>parse</strong> command to convert the device output into a Python dictionary, storing the device data as a set of key-value pairs.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nx_output</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;show inventory&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Verify collected information using the pprint command.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">nx_output</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>The output of the command should contain the following:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">{</span><span class="s1">&#39;name&#39;</span>: <span class="o">{</span><span class="s1">&#39;Chassis&#39;</span>: <span class="o">{</span><span class="s1">&#39;description&#39;</span>: <span class="s1">&#39;Nexus9000 9000v Chassis&#39;</span>,
                    <span class="s1">&#39;pid&#39;</span>: <span class="s1">&#39;N9K-9000v&#39;</span>,
                    <span class="s1">&#39;serial_number&#39;</span>: <span class="s1">&#39;9EIFZPG7ZAM&#39;</span>,
                    <span class="s1">&#39;slot&#39;</span>: <span class="s1">&#39;None&#39;</span>,
                    <span class="s1">&#39;vid&#39;</span>: <span class="s1">&#39;V02&#39;</span><span class="o">}</span>,
        <span class="s1">&#39;Fan 1&#39;</span>: <span class="o">{</span><span class="s1">&#39;description&#39;</span>: <span class="s1">&#39;Nexus9000 9000v Chassis Fan Module&#39;</span>,
                    <span class="s1">&#39;pid&#39;</span>: <span class="s1">&#39;N9K-9000v-FAN&#39;</span>,
                    <span class="s1">&#39;serial_number&#39;</span>: <span class="s1">&#39;N/A&#39;</span>,
                    <span class="s1">&#39;slot&#39;</span>: <span class="s1">&#39;None&#39;</span>,
                    <span class="s1">&#39;vid&#39;</span>: <span class="s1">&#39;V01&#39;</span><span class="o">}</span>,
        <span class="s1">&#39;Fan 2&#39;</span>: <span class="o">{</span><span class="s1">&#39;description&#39;</span>: <span class="s1">&#39;Nexus9000 9000v Chassis Fan Module&#39;</span>,
                    <span class="s1">&#39;pid&#39;</span>: <span class="s1">&#39;N9K-9000v-FAN&#39;</span>,
                    <span class="s1">&#39;serial_number&#39;</span>: <span class="s1">&#39;N/A&#39;</span>,
                    <span class="s1">&#39;slot&#39;</span>: <span class="s1">&#39;None&#39;</span>,
                    <span class="s1">&#39;vid&#39;</span>: <span class="s1">&#39;V01&#39;</span><span class="o">}</span>,
        <span class="s1">&#39;Fan 3&#39;</span>: <span class="o">{</span><span class="s1">&#39;description&#39;</span>: <span class="s1">&#39;Nexus9000 9000v Chassis Fan Module&#39;</span>,
                    <span class="s1">&#39;pid&#39;</span>: <span class="s1">&#39;N9K-9000v-FAN&#39;</span>,
                    <span class="s1">&#39;serial_number&#39;</span>: <span class="s1">&#39;N/A&#39;</span>,
                    <span class="s1">&#39;slot&#39;</span>: <span class="s1">&#39;None&#39;</span>,
                    <span class="s1">&#39;vid&#39;</span>: <span class="s1">&#39;V01&#39;</span><span class="o">}</span>,
        <span class="s1">&#39;Slot 1&#39;</span>: <span class="o">{</span><span class="s1">&#39;description&#39;</span>: <span class="s1">&#39;Nexus 9000v Ethernet Module&#39;</span>,
                    <span class="s1">&#39;pid&#39;</span>: <span class="s1">&#39;N9K-9000v&#39;</span>,
                    <span class="s1">&#39;serial_number&#39;</span>: <span class="s1">&#39;9EIFZPG7ZAM&#39;</span>,
                    <span class="s1">&#39;slot&#39;</span>: <span class="s1">&#39;1&#39;</span>,
                    <span class="s1">&#39;vid&#39;</span>: <span class="s1">&#39;V02&#39;</span><span class="o">}}}</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Since the information is collected in a Python dictionary, we can call any value using its corresponding key. Lets collect the serial number of the chassis using its key.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nx_serial</span> <span class="o">=</span> <span class="n">nx_output</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="s1">&#39;Chassis&#39;</span><span class="p">][</span><span class="s1">&#39;serial_number&#39;</span><span class="p">]</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">nx_serial</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>Collect features state using the <strong>learn</strong> command.</p>
<blockquote>
<div><ul>
<li><p>Run the <strong>learn</strong> command to get the state of the feature (<strong>ospf</strong> in our case) into a Python dictionary, which stores the device data as a set of key-value pairs.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ospf_state_before</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="s1">&#39;ospf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Print collected output to observe the structure of the Python dictionary.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">ospf_state_before</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Run the <strong>parse</strong> command to collect the output of <strong>show interface</strong> in the network.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">int_before</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;show interface&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>Let us now simulate a failure in the topology, shutting down the interface <strong>Ethernet1/1</strong> on the device <strong>nx-osv-1</strong>.</p>
<blockquote>
<div><ul>
<li><p>Open the Putty terminal using the shortcut on the desktop.</p></li>
<li><p>Connect to <strong>nx-osv-1</strong> using the password <strong>cisco</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/putty-01.png"><img alt="../../_images/putty-01.png" class="align-center" src="../../_images/putty-01.png" style="width: 35%;" /></a>
</div></blockquote>
</li>
<li><p>Disable (using the <strong>shutdown</strong> command) interface <strong>Ethernet1/1</strong> on <strong>nx-osv-1</strong>. Issuing the following commands in the console of nx-osv-1:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>configure terminal
interface Ethernet1/1
shutdown
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>In the pyATS shell, run the <strong>learn</strong> command to get the state of the feature (<strong>ospf</strong> in our case) into a Python dictionary, which stores the device data as a set of key-value pairs.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ospf_state_after</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="s1">&#39;ospf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Import the PyATS <strong>Diff</strong> package and compare the previous (working) and current state (failed) to understand what has changed and then troubleshoot the problem.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">genie.utils.diff</span> <span class="kn">import</span> <span class="n">Diff</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">Diff</span><span class="p">(</span><span class="n">ospf_state_before</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="n">ospf_state_after</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
<span class="n">diff</span><span class="o">.</span><span class="n">findDiff</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Diff is one of Genie’s additional Useful Libraries. In the next step, we will explore more useful libraries such as Dq.</p>
</div>
<ul>
<li><p>PyATS Diff can compare outputs of structured data collected by the parse command.</p></li>
<li><p>Convert the <strong>show interface</strong> command into a Python dictionary using the parse method.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">int_after</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;show interface&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Compare the output before and after using the PyATS Diff package.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diff2</span> <span class="o">=</span> <span class="n">Diff</span><span class="p">(</span><span class="n">int_before</span><span class="p">,</span> <span class="n">int_after</span><span class="p">)</span>
<span class="n">diff2</span><span class="o">.</span><span class="n">findDiff</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diff2</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Enable (using the <strong>no shutdown</strong> command) interface <strong>Ethernet1/1</strong> on <strong>nx-osv-1</strong>. Execute the following commands in the console of nx-osv-1:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>configure terminal
interface Ethernet1/1
no shutdown
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Exit the pyATS shell using the exit command and proceed to the next step.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>PyATS’ parse, learn, and diff commands can also be executed directly on a Linux Shell.</p>
<blockquote>
<div><ul>
<li><p>Observe PyATS capabilities from Linux Shell running the pyATS parse command from a Linux Shell:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats parse <span class="s2">&quot;show interface&quot;</span> --devices nx-osv-1 --testbed-file pyats_testbed.yaml --output parse-work/
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Run pyATS learn command from Linux Shell for the OSPF feature:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats learn ospf --devices nx-osv-1 --testbed-file pyats_testbed.yaml --output working/
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Disable (using the <strong>shutdown</strong> command) interface <strong>Ethernet1/1</strong> on <strong>nx-osv-1</strong>.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>configure terminal
interface Ethernet1/1
shutdown
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Return to the Linux Shell, and collect the output by running the pyATS parse command from the Linux Shell:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats parse <span class="s2">&quot;show interface&quot;</span> --devices nx-osv-1 --testbed-file pyats_testbed.yaml --output parse-failed/
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Run the pyATS learn command from the Linux Shell for the OSPF feature:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats learn ospf --devices nx-osv-1 --testbed-file pyats_testbed.yaml --output failed/
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Run the pyATS diff command for the parsed commands from the Linux Shell:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats diff parse-work parse-failed
cat ./diff_nx-osv-1_show-interface_parsed.txt
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Run the pyATS diff for the previously learned states from the Linux Shell:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats diff working failed
cat ./diff_ospf_nxos_nx-osv-1_ops.txt
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Don’t forget to enable (using the <strong>no shutdown</strong> command) interface <strong>Ethernet1/1</strong> on <strong>nx-osv-1</strong>:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>configure terminal
interface Ethernet1/1
no shutdown
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ol>
<p><em>Section author: Luis Rueda &lt;<a class="reference external" href="mailto:lurueda&#37;&#52;&#48;cisco&#46;com">lurueda<span>&#64;</span>cisco<span>&#46;</span>com</a>&gt;, Jairo Leon &lt;<a class="reference external" href="mailto:jaileon&#37;&#52;&#48;cisco&#46;com">jaileon<span>&#64;</span>cisco<span>&#46;</span>com</a>&gt;</em></p>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="step2.html" class="btn btn-neutral float-left" title="Step 2: Verify pyATS Testbed File" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="step4.html" class="btn btn-neutral float-right" title="Step 4: pyATS Shell Useful Libraries" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Cisco Systems, Inc. 2020.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>